# ------------------------------------------------------------------------
# OWASP ModSecurity Core Rule Set ver.3.3.0
# Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved.
#
# The OWASP ModSecurity Core Rule Set is distributed under
# Apache Software License (ASL) version 2
# Please see the enclosed LICENSE file for full details.
# ------------------------------------------------------------------------


#
# -- [[ Introduction ]] --------------------------------------------------------
#
# The OWASP ModSecurity Core Rule Set (CRS) is a set of generic attack
# detection rules that provide a base level of protection for any web
# application. They are written for the open source, cross-platform
# ModSecurity Web Application Firewall.
#
# See also:
# https://coreruleset.org/
# https://github.com/SpiderLabs/owasp-modsecurity-crs
# https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project
#


#
# -- [[ System Requirements ]] -------------------------------------------------
#
# CRS requires ModSecurity version 2.8.0 or above.
# We recommend to always use the newest ModSecurity version.
#
# The configuration directives/settings in this file are used to control
# the OWASP ModSecurity CRS. These settings do **NOT** configure the main
# ModSecurity settings (modsecurity.conf) such as SecRuleEngine,
# SecRequestBodyAccess, SecAuditEngine, SecDebugLog, and XML processing.
#
# The CRS assumes that modsecurity.conf has been loaded. It is bundled with
# ModSecurity. If you don't have it, you can get it from:
# 2.x: https://raw.githubusercontent.com/SpiderLabs/ModSecurity/v2/master/modsecurity.conf-recommended
# 3.x: https://raw.githubusercontent.com/SpiderLabs/ModSecurity/v3/master/modsecurity.conf-recommended
#
# The order of file inclusion in your webserver configuration should always be:
# 1. modsecurity.conf
# 2. crs-setup.conf (this file)
# 3. rules/*.conf (the CRS rule files)
#
# Please refer to the INSTALL file for detailed installation instructions.
#


#
# -- [[ Mode of Operation: Anomaly Scoring vs. Self-Contained ]] ---------------
#
# The CRS can run in two modes:
#
# -- [[ Anomaly Scoring Mode (default) ]] --
# In CRS3, anomaly mode is the default and recommended mode, since it gives the
# most accurate log information and offers the most flexibility in setting your
# blocking policies. It is also called "collaborative detection mode".
# In this mode, each matching rule increases an 'anomaly score'.
# At the conclusion of the inbound rules, and again at the conclusion of the
# outbound rules, the anomaly score is checked, and the blocking evaluation
# rules apply a disruptive action, by default returning an error 403.
#
# -- [[ Self-Contained Mode ]] --
# In this mode, rules apply an action instantly. This was the CRS2 default.
# It can lower resource usage, at the cost of less flexibility in blocking policy
# and less informative audit logs (only the first detected threat is logged).
# Rules inherit the disruptive action that you specify (i.e. deny, drop, etc).
# The first rule that matches will execute this action. In most cases this will
# cause evaluation to stop after the first rule has matched, similar to how many
# IDSs function.
#
# -- [[ Alert Logging Control ]] --
# In the mode configuration, you must also adjust the desired logging options.
# There are three common options for dealing with logging. By default CRS enables
# logging to the webserver error log (or Event viewer) plus detailed logging to
# the ModSecurity audit log (configured under SecAuditLog in modsecurity.conf).
#
# - To log to both error log and ModSecurity audit log file, use: "log,auditlog"
# - To log *only* to the ModSecurity audit log file, use: "nolog,auditlog"
# - To log *only* to the error log file, use: "log,noauditlog"
#
# Examples for the various modes follow.
# You must leave one of the following options enabled.
# Note that you must specify the same line for phase:1 and phase:2.
#

# Default: Anomaly Scoring mode, log to error log, log to ModSecurity audit log
# - By default, offending requests are blocked with an error 403 response.
# - To change the disruptive action, see RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example
#   and review section 'Changing the Disruptive Action for Anomaly Mode'.
# - In Apache, you can use ErrorDocument to show a friendly error page or
#   perform a redirect: https://httpd.apache.org/docs/2.4/custom-error.html
#
SecDefaultAction "phase:1,log,auditlog,deny,status:403"
SecDefaultAction "phase:2,log,auditlog,deny,status:403"

# Example: Anomaly Scoring mode, log only to ModSecurity audit log
# - By default, offending requests are blocked with an error 403 response.
# - To change the disruptive action, see RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example
#   and review section 'Changing the Disruptive Action for Anomaly Mode'.
# - In Apache, you can use ErrorDocument to show a friendly error page or
#   perform a redirect: https://httpd.apache.org/docs/2.4/custom-error.html
#
# SecDefaultAction "phase:1,nolog,auditlog,pass"
# SecDefaultAction "phase:2,nolog,auditlog,pass"

# Example: Self-contained mode, return error 403 on blocking
# - In this configuration the default disruptive action becomes 'deny'. After a
#   rule triggers, it will stop processing the request and return an error 403.
# - You can also use a different error status, such as 404, 406, et cetera.
# - In Apache, you can use ErrorDocument to show a friendly error page or
#   perform a redirect: https://httpd.apache.org/docs/2.4/custom-error.html
#
# SecDefaultAction "phase:1,log,auditlog,deny,status:403"
# SecDefaultAction "phase:2,log,auditlog,deny,status:403"

# Example: Self-contained mode, redirect back to homepage on blocking
# - In this configuration the 'tag' action includes the Host header data in the
#   log. This helps to identify which virtual host triggered the rule (if any).
# - Note that this might cause redirect loops in some situations; for example
#   if a Cookie or User-Agent header is blocked, it will also be blocked when
#   the client subsequently tries to access the homepage. You can also redirect
#   to another custom URL.
# SecDefaultAction "phase:1,log,auditlog,redirect:'http://%{request_headers.host}/',tag:'Host: %{request_headers.host}'"
# SecDefaultAction "phase:2,log,auditlog,redirect:'http://%{request_headers.host}/',tag:'Host: %{request_headers.host}'"


#
# -- [[ Paranoia Level Initialization ]] ---------------------------------------
#
# The Paranoia Level (PL) setting allows you to choose the desired level
# of rule checks that will add to your anomaly scores.
#
# With each paranoia level increase, the CRS enables additional rules
# giving you a higher level of security. However, higher paranoia levels
# also increase the possibility of blocking some legitimate traffic due to
# false alarms (also named false positives or FPs). If you use higher
# paranoia levels, it is likely that you will need to add some exclusion
# rules for certain requests and applications receiving complex input.
#
# - A paranoia level of 1 is default. In this level, most core rules
#   are enabled. PL1 is advised for beginners, installations
#   covering many different sites and applications, and for setups
#   with standard security requirements.
#   At PL1 you should face FPs rarely. If you encounter FPs, please
#   open an issue on the CRS GitHub site and don't forget to attach your
#   complete Audit Log record for the request with the issue.
# - Paranoia level 2 includes many extra rules, for instance enabling
#   many regexp-based SQL and XSS injection protections, and adding
#   extra keywords checked for code injections. PL2 is advised
#   for moderate to experienced users desiring more complete coverage
#   and for installations with elevated security requirements.
#   PL2 comes with some FPs which you need to handle.
# - Paranoia level 3 enables more rules and keyword lists, and tweaks
#   limits on special characters used. PL3 is aimed at users experienced
#   at the handling of FPs and at installations with a high security
#   requirement.
# - Paranoia level 4 further restricts special characters.
#   The highest level is advised for experienced users protecting
#   installations with very high security requirements. Running PL4 will
#   likely produce a very high number of FPs which have to be
#   treated before the site can go productive.
#
# All rules will log their PL to the audit log;
# example: [tag "paranoia-level/2"]. This allows you to deduct from the
# audit log how the WAF behavior is affected by paranoia level.
#
# It is important to also look into the variable
# tx.enforce_bodyproc_urlencoded (Enforce Body Processor URLENCODED)
# defined below. Enabling it closes a possible bypass of CRS.
#
# Uncomment this rule to change the default:
#
SecAction \
  "id:900000,\
   phase:1,\
   nolog,\
   pass,\
   t:none,\
   setvar:tx.paranoia_level=1" # was 1 - 0xTaylor
# Enabled - 0xTaylor

# It is possible to execute rules from a higher paranoia level but not include
# them in the anomaly scoring. This allows you to take a well-tuned system on
# paranoia level 1 and add rules from paranoia level 2 without having to fear
# the new rules would lead to false positives that raise your score above the
# threshold.
# This optional feature is enabled by uncommenting the following rule and
# setting the tx.executing_paranoia_level.
# Technically, rules up to the level defined in tx.executing_paranoia_level
# will be executed, but only the rules up to tx.paranoia_level affect the
# anomaly scores.
# By default, tx.executing_paranoia_level is set to tx.paranoia_level.
# tx.executing_paranoia_level must not be lower than tx.paranoia_level.
#
# Please notice that setting tx.executing_paranoia_level to a higher paranoia
# level results in a performance impact that is equally high as setting
# tx.paranoia_level to said level.
#
#SecAction \
#  "id:900001,\
#   phase:1,\
#   nolog,\
#   pass,\
#   t:none,\
#   setvar:tx.executing_paranoia_level=1"


#
# -- [[ Enforce Body Processor URLENCODED ]] -----------------------------------
#
# ModSecurity selects the body processor based on the Content-Type request
# header. But clients are not always setting the Content-Type header for their
# request body payloads. This will leave ModSecurity with limited vision into
# the payload.  The variable tx.enforce_bodyproc_urlencoded lets you force the
# URLENCODED body processor in these situations. This is off by default, as it
# implies a change of the behaviour of ModSecurity beyond CRS (the body
# processor applies to all rules, not only CRS) and because it may lead to
# false positives already on paranoia level 1. However, enabling this variable
# closes a possible bypass of CRS so it should be considered.
#
# Uncomment this rule to change the default:
#
#SecAction \
#  "id:900010,\
#   phase:1,\
#   nolog,\
#   pass,\
#   t:none,\
#   setvar:tx.enforce_bodyproc_urlencoded=1"


#
# -- [[ Anomaly Mode Severity Levels ]] ----------------------------------------
#
# Each rule in the CRS has an associated severity level.
# These are the default scoring points for each severity level.
# These settings will be used to increment the anomaly score if a rule matches.
# You may adjust these points to your liking, but this is usually not needed.
#
# - CRITICAL severity: Anomaly Score of 5.
#       Mostly generated by the application attack rules (93x and 94x files).
# - ERROR severity: Anomaly Score of 4.
#       Generated mostly from outbound leakage rules (95x files).
# - WARNING severity: Anomaly Score of 3.
#       Generated mostly by malicious client rules (91x files).
# - NOTICE severity: Anomaly Score of 2.
#       Generated mostly by the protocol rules (92x files).
#
# In anomaly mode, these scores are cumulative.
# So it's possible for a request to hit multiple rules.
#
# (Note: In this file, we use 'phase:1' to set CRS configuration variables.
# In general, 'phase:request' is used. However, we want to make absolutely sure
# that all configuration variables are set before the CRS rules are processed.)
#
SecAction \
 "id:900100,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.critical_anomaly_score=5,\
  setvar:tx.error_anomaly_score=4,\
  setvar:tx.warning_anomaly_score=3,\
  setvar:tx.notice_anomaly_score=1" # was originally 2 - 0xTaylor


#
# -- [[ Anomaly Mode Blocking Threshold Levels ]] ------------------------------
#
# Here, you can specify at which cumulative anomaly score an inbound request,
# or outbound response, gets blocked.
#
# Most detected inbound threats will give a critical score of 5.
# Smaller violations, like violations of protocol/standards, carry lower scores.
#
# [ At default value ]
# If you keep the blocking thresholds at the defaults, the CRS will work
# similarly to previous CRS versions: a single critical rule match will cause
# the request to be blocked and logged.
#
# [ Using higher values ]
# If you want to make the CRS less sensitive, you can increase the blocking
# thresholds, for instance to 7 (which would require multiple rule matches
# before blocking) or 10 (which would require at least two critical alerts - or
# a combination of many lesser alerts), or even higher. However, increasing the
# thresholds might cause some attacks to bypass the CRS rules or your policies.
#
# [ New deployment strategy: Starting high and decreasing ]
# It is a common practice to start a fresh CRS installation with elevated
# anomaly scoring thresholds (>100) and then lower the limits as your
# confidence in the setup grows. You may also look into the Sampling
# Percentage section below for a different strategy to ease into a new
# CRS installation.
#
# [ Anomaly Threshold / Paranoia Level Quadrant ]
#
#     High Anomaly Limit   |   High Anomaly Limit
#     Low Paranoia Level   |   High Paranoia Level
#     -> Fresh Site        |   -> Experimental Site
# ------------------------------------------------------
#     Low Anomaly Limit    |   Low Anomaly Limit
#     Low Paranoia Level   |   High Paranoia Level
#     -> Standard Site     |   -> High Security Site
#
# Uncomment this rule to change the defaults:
#
SecAction \
 "id:900110,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.inbound_anomaly_score_threshold=5,\
  setvar:tx.outbound_anomaly_score_threshold=4"
  # Enabled - 0xTaylor

#
# -- [[ Application Specific Rule Exclusions ]] ----------------------------------------
#
# Some well-known applications may undertake actions that appear to be
# malicious. This includes actions such as allowing HTML or Javascript within
# parameters. In such cases the CRS aims to prevent false positives by allowing
# administrators to enable prebuilt, application specific exclusions on an
# application by application basis.
# These application specific exclusions are distinct from the rules that would
# be placed in the REQUEST-900-EXCLUSION-RULES-BEFORE-CRS configuration file as
# they are prebuilt for specific applications. The 'REQUEST-900' file is
# designed for users to add their own custom exclusions. Note, using these
# application specific exclusions may loosen restrictions of the CRS,
# especially if used with an application they weren't designed for. As a result
# they should be applied with care.
# To use this functionality you must specify a supported application. To do so
# uncomment rule 900130. In addition to uncommenting the rule you will need to
# specify which application(s) you'd like to enable exclusions for. Only a
# (very) limited set of applications are currently supported, please use the
# filenames prefixed with 'REQUEST-903' to guide you in your selection.
# Such filenames use the following convention:
# REQUEST-903.9XXX-{APPNAME}-EXCLUSIONS-RULES.conf
#
# It is recommended if you run multiple web applications on your site to limit
# the effects of the exclusion to only the path where the excluded webapp
# resides using a rule similar to the following example:
# SecRule REQUEST_URI "@beginsWith /wordpress/" setvar:tx.crs_exclusions_wordpress=1

#
# Modify and uncomment this rule to select which application:
#
#SecAction \
# "id:900130,\
#  phase:1,\
#  nolog,\
#  pass,\
#  t:none,\
#  setvar:tx.crs_exclusions_cpanel=1,\
#  setvar:tx.crs_exclusions_drupal=1,\
#  setvar:tx.crs_exclusions_dokuwiki=1,\
#  setvar:tx.crs_exclusions_nextcloud=1,\
#  setvar:tx.crs_exclusions_wordpress=1,\
#  setvar:tx.crs_exclusions_xenforo=1"

#
# -- [[ HTTP Policy Settings ]] ------------------------------------------------
#
# This section defines your policies for the HTTP protocol, such as:
# - allowed HTTP versions, HTTP methods, allowed request Content-Types
# - forbidden file extensions (e.g. .bak, .sql) and request headers (e.g. Proxy)
#
# These variables are used in the following rule files:
# - REQUEST-911-METHOD-ENFORCEMENT.conf
# - REQUEST-912-DOS-PROTECTION.conf
# - REQUEST-920-PROTOCOL-ENFORCEMENT.conf

# HTTP methods that a client is allowed to use.
# Default: GET HEAD POST OPTIONS
# Example: for RESTful APIs, add the following methods: PUT PATCH DELETE
# Example: for WebDAV, add the following methods: CHECKOUT COPY DELETE LOCK
#          MERGE MKACTIVITY MKCOL MOVE PROPFIND PROPPATCH PUT UNLOCK
# Uncomment this rule to change the default.
SecAction \
 "id:900200,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.allowed_methods=GET'"

# Content-Types that a client is allowed to send in a request.
# Default: |application/x-www-form-urlencoded| |multipart/form-data| |multipart/related|
# |text/xml| |application/xml| |application/soap+xml| |application/x-amf| |application/json|
# |application/cloudevents+json| |application/cloudevents-batch+json| |application/octet-stream|
# |application/csp-report| |application/xss-auditor-report| |text/plain|
# Uncomment this rule to change the default.
SecAction \
 "id:900220,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.allowed_request_content_type=|text/html| |application/json| |application/javascript| |image/png| |font/woff2| |image/x-icon|'"

#  setvar:'tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |multipart/related| |text/xml| |application/xml| |application/soap+xml| |application/x-amf| |application/json| |application/cloudevents+json| |application/cloudevents-batch+json| |application/octet-stream| |application/csp-report| |application/xss-auditor-report| |text/plain|'"



# Allowed HTTP versions.
# Default: HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0
# Example for legacy clients: HTTP/0.9 HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0
# Note that some web server versions use 'HTTP/2', some 'HTTP/2.0', so
# we include both version strings by default.
# Uncomment this rule to change the default.
SecAction \
 "id:900230,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.allowed_http_versions=HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0'"

# Forbidden file extensions.
# Guards against unintended exposure of development/configuration files.
# Default: .asa/ .asax/ .ascx/ .axd/ .backup/ .bak/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/ .csproj/ .csr/ .dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .ini/ .key/ .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/ .pol/ .printer/ .pwd/ .rdb/ .resources/ .resx/ .sql/ .swp/ .sys/ .vb/ .vbs/ .vbproj/ .vsdisco/ .webinfo/ .xsd/ .xsx/
# Example: .bak/ .config/ .conf/ .db/ .ini/ .log/ .old/ .pass/ .pdb/ .rdb/ .sql/
# Uncomment this rule to change the default.
SecAction \
 "id:900240,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.restricted_extensions=.0--DUP.htm/ .0-0-0.html/ .0-features-print.htm/ .0-pl1/ .0-rc1/ .0-to-1.2.php/ .0-to1.2.php/ .0.11-pr1/ .0/ .001.L.jpg/ .002.L.jpg/ .003.L.jpg/ .004.L.jpg/ .006.L.jpg/ .01-L.jpg/ .030-i486/ .0b/ .1_stable/ .1-3.2.php/ .1-all-languages/ .1-bin-Linux-2.0.30-i486/ .1-bin-Linux-2.030-i486/ .1-en/ .1-english/ .1-pt_BR/ .1-rc1/ .1.24-print.htm/ .10a/ .11-pr1/ .11.5-all-languages-utf-8-only/ .11.6-all-languages/ .12D6/ .12EA/ .13BA/ .13F8/ .15F4/ .161E/ .16BE/ .17CC/ .18A/ .191E/ .199C/ .1a/ .1ADE/ .1c/ .1C2E/ .1C50/ .1CD6/ .1D8C/ .1E0/ .2-english/ .2-rc1/ .20A6/ .24stable/ .25CE/ .2a/ .2ABE/ .2b/ .2B26/ .2CC/ .2CD0/ .2D1A/ .2DE/ .2E4/ .2E98/ .2EE2/ .2ms2/ .3-pl1/ .3-rc1/ .3.7-english/ .30-i486/ .308E/ .33E0/ .346A/ .347A/ .347C/ .35B8/ .37C2/ .3EA/ .3F54/ .3gp/ .4-all-languages/ .40.00.573N35.42.57.445/ .41A2/ .42BA/ .43CA/ .43FA/ .46A2/ .46D4/ .47F6/ .497C/ .4A4/ .4A84/ .4B88/ .4C6/ .4CC/ .4D3C/ .4D6C/ .4FB8/ .5_mod_for_host/ .5-all-languages-utf-8-only/ .5-pl1/ .5.1-pt_BR/ .5.5-pl1/ .5.7-pl1/ .50A/ .5B0/ .5E0/ .5E5E/ .6-all-languages/ .6.0-pl1/ .6.2-rc1/ .6.3-pl1/ .6.3-rc1/ .65E/ .67E/ .69A/ .6A0/ .6CE/ .6D2/ .6D6/ .6DA/ .6EE/ .6F8/ .6FA/ .6FC/ .7_0_A/ .7-english/ .7-pl1/ .71a/ .71E/ .73C/ .77C/ .78A/ .79C/ .7AB6/ .7AE/ .7AF8/ .7B0/ .7B30/ .7B5E/ .7C6/ .7C8/ .7CA/ .7CC/ .7D6/ .7E6/ .7F0/ .7F4/ .7FA/ .7FE/ .7z/ .80A/ .80E/ .84CA/ .84E/ .87C/ .88C/ .89E/ .8a/ .8AE/ .8B0/ .8C6/ .8D68/ .8DC/ .8E6/ .8EC/ .8EE/ .97C/ .99E/ .9A6/ .9C/ .9CEE/ .9D2/ .A./ .a/ .A/ .A00/ .A02/ .A22/ .A34/ .A40/ .A4A/ .A50/ .A58/ .A5CA/ .a5w/ .A8A/ .aac/ .AB60/ .AC0/ .AC2/ .ACA2/ .accdb/ .access/ .acgi/ .Acquisition/ .act/ .action/ .action2/ .actions/ .AdCode/ .add/ .adm/ .admin/ .Admin/ .adp/ .ads/ .advsearch/ .AE2/ .AEFA/ .AF54/ .AF90/ .ai/ .aj_/ .ajax/ .alhtm/ .all/ .alt/ .ALT/ .andriy.lviv.ua/ .ani/ .ap/ .apf/ .api/ .apj/ .apk/ .app/ .application/ .Appraisal/ .apsx/ .aquery/ .ar/ .arc/ .archiv/ .arj/ .array-key-exists/ .array-keys/ .array-map/ .array-merge/ .array-rand/ .array-values/ .art/ .artdeco/ .articlePk/ .artnet./ .as/ .asa/ .asax/ .ASC./ .asc/ .ascx/ .asd/ .asf/ .ashx/ .asia/ .asm/ .asmx/ .asp_/ .asp_files/ .asp-/ .asp/ .p/ .Asp/ .ASP/ .asp1/ .asp2/ .aspDONOTUSE/ .aspg/ .aspl/ .aspp/ .asps/ .aspx_files/ .aspx./ .aspx/ .Aspx/ .ASPX/ .aspxx/ .aspy/ .assets/ .asx/ .asxp/ .at/ .atom/ .au/ .avi/ .AVI/ .award/ .awm/ .awstats/ .axd/ .b/ .B04/ .B18/ .B1C/ .B2C/ .B38/ .B50/ .B5E/ .B70/ .B7A/ .B8A/ .back/ .backup/ .bad/ .bak/ .BAK/ .bak2/ .barnes/ .bat/ .baut/ .BBC/ .bc/ .bck/ .BD0/ .beta/ .bfhtm/ .bhtml/ .biminifinder/ .bin/ .biz/ .bk/ .bkp/ .blog/ .bml/ .bmp/ .BMP/ .bok/ .boom/ .br/ .browse/ .browser/ .bsp/ .btr/ .bu/ .build/ .buscar/ .buyadspace/ .bycategory/ .bylocation/ .bz/ .bz2/ .C./ .C.R.D./ .c/ .C38/ .C44/ .C50/ .C68/ .C72/ .C78/ .C7C/ .C84/ .ca/ .CAA/ .cab/ .CAB/ .cache.inc.php/ .cache/ .calendar/ .call-user-func-array/ .captcha/ .car/ .cart/ .casino/ .cat/ .catalog/ .categorias/ .categories/ .CB8/ .CBC/ .cc/ .CC0/ .ccs/ .cdf/ .cdr/ .ce/ .cer/ .CF4/ .CF6/ .cfc/ .cfg/ .cfm/ .Cfm/ .CFM/ .cfml/ .cfswf/ .cfx/ .cgi/ .CGI/ .cgis/ .ch/ .chat/ .chdir/ .children/ .chm/ .cl/ .class/ .cls/ .cmd/ .cmp/ .cms.ad.AdServer.cls/ .cms/ .cn/ .cnf/ .cnt/ .co/ .code/ .com_Backup_/ .com_Backup_Giornaliero/ .com_Backup_Settimanale/ .com_files/ .com-authorization-required.html/ .com-bad-request.html/ .com-forbidden.html/ .com-internal-server-error.html/ .com-page-not-found.html/ .com-redirect/ .com-tov.html/ .com/ .COM/ .comments./ .comments/ .Commerce/ .common/ .conf/ .config/ .Config/ .console/ .contact/ .content/ .contrib/ .control/ .controller/ .controls-3.1.5.swf/ .Controls/ .copy/ .core/ .CorelProject/ .corp/ .count/ .coverfinder/ .cp/ .cqs/ .cron/ .crt/ .crx/ .cs/ .cs2/ .csi/ .csp/ .csproj/ .csr/ .Css/ .CSS/ .cssd/ .csv/ .ctp/ .cur/ .custom/ .cvsignore/ .cx/ .cz/ .D./ .D.R./ .d/ .D20/ .d2w/ .d64/ .D7A/ .daisy/ .dal/ .daniel/ .dat/ .data_/ .data/ .davis/ .db/ .dbf/ .DBF/ .dbm/ .dbml/ .DC2/ .dcf/ .dcr/ .dct/ .de/ .deb/ .default/ .del/ .delete/ .deleted/ .dell/ .demo/ .DESC./ .detail/ .dev.bka.co.nz/ .dev/ .development/ .dhtml/ .dic/ .diff/ .dig/ .dir/ .Direct/ .disabled/ .dist/ .divx/ .djvu/ .dk/ .dll/ .DLL/ .dm/ .dmb/ .dmg/ .dms/ .dnn/ .DnnWebService/ .do/ .doc/ .Doc/ .DOC/ .docx/ .DOCX/ .dogpl/ .dontcopy/ .dot/ .download/ .ds/ .dta/ .dtd/ .du/ .dump/ .dwf/ .dwg/ .dws/ .dwt/ .dxf/ .dyn/ .E./ .e/ .E46/ .E96/ .EA0/ .EBA/ .ebay.results.html/ .ebay/ .EC0/ .ece/ .ed/ .EDE/ .edit/ .edu/ .EEA/ .EF8/ .egov/ .ehtml/ .email/ .Email/ .eml/ .en/ .enfinity/ .engine/ .Engineer/ .enn/ .enu/ .env/ .eot/ .ep/ .epc/ .epl/ .eps/ .epub/ .err/ .error-log/ .error/ .errors/ .es/ .esp/ .eu/ .eur/ .Eus/ .ex/ .exc/ .excel.xml.php/ .exclude/ .exe/ .EXE/ .exec/ .exp/ .ext/ .external/ .extract/ .f.l./ .F22/ .F46/ .f4v/ .F54/ .faces/ .FAE/ .fancybox/ .faucetdepot/ .fb2/ .fcgi/ .fdml/ .feed/ .ffa/ .ficheros/ .fichiers/ .fil/ .file-get-contents/ .file-put-contents/ .file/ .filemtime/ .filereader/ .files/ .filesize/ .film/ .fla/ .flac/ .flush/ .flv/ .flypage/ .fmt/ .fn/ .fon/ .footer/ .fopen/ .form_jhtml/ .form/ .forms/ .forum/ .found/ .fp7/ .fpl/ .fr/ .framework/ .fread/ .friend/ .frk/ .FRK/ .fsockopen/ .ft/ .ftl/ .g./ .g/ .garcia/ .gb/ .geo/ .get-meta-tags/ .get/ .getimagesize/ .GetMapImage/ .ghtml/ .gif .gif_var_DE/ .gif/ .Gif/ .GIF/ .girlvandiesuburbs.co.za/ .git/ .gitignore/ .go/ .google/ .googlebook/ .gov/ .gpg/ .gpx/ .gray/ .grp/ .gsp/ .gutschein/ .guy/ .gz/ .H.I./ .h/ .ha/ .hawaii/ .henry/ .him/ .history/ .hl/ .hlr/ .hm/ .hml/ .hmtl/ .ho/ .hokkaido/ .hold/ .home/ .homepage/ .hotelName/ .hp/ .hqx/ .href/ .ht/ .hta/ .htaccess/ .htc/ .htlm/ .htm_/ .htm./ .htm/ .HTM/ .htm~/ .htm2/ .htm3/ .htm5/ .htm7/ .htm8/ .html_/ .html_files/ .html_old/ .html_var_DE/ .html-/ .html-0/ .html-1/ .html-c/ .html-old/ .html-p/ .html./ .html}/ .Html/ .HTML/ .html1/ .html4/ .html5/ .html7/ .htmla/ .htmlBAK/ .htmlc/ .htmlDolmetschen/ .htmlfeed/ .htmll/ .htmlpar/ .htmlprint/ .htmlq/ .htmls/ .htmlu/ .htn/ .htpasswd/ .hts/ .htx/ .hu/ .hwp/ .i/ .iac./ .ibf/ .ice/ .iconv/ .ics/ .ida/ .idf/ .idq/ .idx/ .iframe_filtros/ .ihmtl/ .ihtml/ .ihya/ .il/ .image/ .imagecreatetruecolor/ .imagejpeg/ .images/ .img/ .iml/ .imp/ .implode/ .imprimer-cadre/ .imprimer/ .imprimir-marco/ .imprimir/ .in-array/ .in/ .inactive/ .inc.php.bak/ .inc/ .INC/ .incl/ .include-once/ .include/ .includes/ .Includes/ .index/ .indt/ .inf/ .info/ .INFO/ .ini/ .INI/ .inl/ .insert/ .inv/ .ipl/ .iso/ .ISO/ .issues/ .it_Backup_Giornaliero/ .it_Backup_Settimanale/ .it/ .itml/ .ixi/ .j/ .jad/ .jar/ .java/ .jbf/ .jhtm/ .jhtml/ .jnlp/ .job/ .join/ .joseph/ .jp/ .jpe/ .jpeg/ .Jpeg/ .JPEG/ .jpf/ .jpg/ .Jpg/ .JPG/ .jps/ .JS/ .js2/ .jsa/ .jsd/ .jsf/ .jso/ .json/ .jsp/ .jspa/ .jspf/ .jsps/ .jspx/ .jtp/ .K.E./ .K.T./ .KB/ .key/ .keyword/ .kit/ .kk/ .kml/ .kmz/ .kokuken/ .ks/ .L./ .l/ .lang/ .lasso/ .LassoApp/ .last/ .latest/ .layer/ .lbi/ .lck/ .LCK/ .letter/ .lha/ .lib/ .lic/ .licx/ .lignee/ .link/ .links/ .list/ .listevents/ .listing/ .listMiniGrid/ .lng/ .lnk/ .load/ .loc/ .local/ .lock/ .log/ .LOG/ .log2/ .login/ .lst/ .ltr/ .lua/ .lynkx/ .lzh/ .m/ .m3u/ .m4a/ .m4v/ .mag/ .mail/ .main/ .Main/ .manager/ .maninfo/ .map/ .master/ .Master/ .MAXIMIZE/ .mbizgroup/ .mbox/ .mc_id/ .md5/ .mdb/ .media/ .mel/ .members/ .met/ .metadesc/ .metakeys/ .mgi/ .mht/ .mhtml/ .mi/ .mid/ .midi/ .min_/ .min/ .mkdir/ .mkv/ .mld/ .MLD/ .mmap/ .mno/ .mobi/ .mobile/ .mod/ .mov/ .MOV/ .mp/ .mp2/ .mp3/ .MP3/ .mp4/ .mpeg/ .MPEG/ .mpg/ .MPG/ .mpl/ .mq4/ .msg/ .msi/ .mso/ .msp/ .mspx/ .mv/ .mv4/ .mvc/ .mvn/ .mysql-connect/ .mysql-pconnect/ .mysql-query/ .mysql-result/ .mysql-select-db/ .mysql/ .mysqli/ .n/ .napravlenie_ASC/ .napravlenie_DESC/ .nded-pga-emial/ .NDM/ .net_Backup_Giornaliero/ .net_Backup_Settimanale/ .net-en/ .net-print.htm/ .net-tov.html/ .net/ .NET/ .new/ .NEWCONFIGPOSSIBLYBROKEN/ .news/ .newsletter/ .nfo/ .nikon/ .nl/ .nodos/ .none/ .nsf/ .NSF/ .nth/ .num/ .nxg/ .nz/ .o/ .obyx/ .ocx/ .od/ .ods/ .odt/ .off/ .offline/ .ogg/ .ogv/ .ok/ .old/ .Old/ .OLD/ .old1/ .old2/ .old3/ .older/ .oliver/ .online/ .open/ .opendir/ .opensearch/ .opml/ .ord/ .org-tov.html/ .Org.master.cs/ .org.ua-tov.html/ .org/ .ori/ .orig/ .original/ .osg/ .oui/ .out/ .outbound/ .outcontrol/ .owen/ .P./ .p/ .p3p/ .p7b/ .pac/ .pad/ .pae/ .page_pls_all_password/ .page/ .PAGE/ .pages/ .pan/ .parse-url/ .part/ .partfinder/ .pass/ .patch/ .paul/ .pd/ .pdb/ .pdd/ .pdf./ .pdf/ .Pdf/ .PDF/ .pdfx/ .pem/ .pfx/ .pgp/ .pgt/ .ph/ .phdo/ .pho/ .photo/ .php_/ .php_files/ .php_old/ .php_OLD/ .php--------------/ .php-/ .php-dist/ .php./ .php}/ .php/ .Php/ .PHP/ .php~/ .php1/ .php2/ .php3/ .php4/ .php5/ .phphp/ .phpl/ .phpp/ .phppar/ .phps/ .phpx/ .pht/ .phtm/ .phtml/ .pix/ .pl/ .pls/ .plugins/ .plx/ .pm/ .pnp/ .po/ .pop_3D_viewer/ .pop_formata_viewer/ .popup/ .portal/ .pot/ .pps/ .ppt/ .PPT/ .pptx/ .prc/ .pre/ .preg-match/ .prep/ .prev_next/ .prev/ .preview-content.php/ .preview/ .prg/ .prhtm/ .price/ .print-frame/ .print./ .print/ .printable/ .printer/ .prl/ .process/ .product_details/ .properties/ .propfinder/ .prt/ .ps/ .psb/ .psd/ .PSD/ .psp/ .psql/ .pub/ .Publish/ .pvk/ .pvx/ .pwd/ .py/ .pyc/ .q/ .qtgp/ .query/ .qxd/ .r./ .r/ .R/ .ra/ .rabattlp/ .rails/ .ram/ .randomhouse/ .rar/ .raw/ .RAW/ .rb/ .rc/ .rdf/ .read/ .readfile/ .readme_var_DE/ .readme/ .rec/ .recherche/ .red/ .redirect/ .reg/ .registration/ .remove/ .removed/ .req/ .require-once/ .require/ .resultados/ .results/ .resume/ .resx/ .rhtm/ .rhtml/ .rm/ .rmvb/ .ro/ .roma/ .rpm/ .rpt/ .rsp/ .rss_cars/ .rss_homes/ .rss_jobs/ .rss/ .rtf/ .rtfd/ .ru/ .run/ .rvt/ .s/ .S/ .s7/ .safariextz/ .safe/ .sample/ .sav/ .save/ .sbk/ .sc/ .scandir/ .scc/ .scripts/ .sdb/ .se/ .sea/ .seam/ .search./ .search/ .sec/ .section/ .secure/ .sema/ .send/ .sendtoafriendform/ .sent-/ .seo/ .ser/ .serv/ .server/ .service/ .Services/ .servlet/ .session-regenerate-id/ .session-start/ .session/ .set/ .settings/ .setup/ .sf/ .sfw/ .sgf/ .sh/ .shop/ .show/ .sht/ .shtm/ .shtml/ .sidebar/ .SideMenu/ .SIM/ .simplexml-load-file/ .sis/ .sisx/ .sit/ .site/ .sitemap./ .sitemap/ .sitx/ .skin/ .skins/ .Skins/ .sln/ .smi/ .smil/ .so/ .Sol.BBCRedirection.page/ .sort/ .sp/ .sph/ .sphp3/ .split/ .Sponsors/ .sql/ .SQL/ .squery/ .src/ .srch/ .srf/ .srv/ .srvl/ .ssf/ .ssi/ .sso/ .sta/ .staging/ .start/ .stat/ .static/ .stats/ .ste/ .step/ .stm/ .stml/ .store/ .storefront/ .story/ .strpos/ .suarez/ .submit/ .subscribe/ .suo/ .support/ .svc/ .svg/ .svn/ .swd/ .swf/ .SWF/ .swi/ .swp/ .sxw/ .sym/ .sys/ .system/ .T.A./ .t/ .tab-/ .taf/ .tar/ .tb/ .tcl/ .tech/ .tem/ .temp/ .template/ .templates/ .Templates/ .temporarily.withdrawn.html/ .test/ .TEST/ .tex/ .text/ .textsearch/ .tf/ .tg/ .tga/ .tgz/ .thanks/ .theme/ .thm/ .thompson/ .thtml/ .tif/ .tiff/ .tim/ .tk/ .tlp/ .tls/ .tml/ .tmp/ .tmpl/ .to/ .top/ .torrent/ .touch/ .tpl/ .trace/ .trade/ .trck/ .ts/ .tst/ .tsv/ .ttf/ .TTF/ .tv/ .tvpi/ .txt./ .txt/ .TXT/ .types/ .ua/ .ufo/ .ug/ .uguide/ .ui-1.5.2/ .uk/ .unlink/ .unsubscribe/ .unternehmen/ .update/ .upgrade/ .url/ .us/ .user/ .utf8/ .v/ .var/ .vb/ .vbproj/ .vbs/ .vcf/ .vcs/ .verify/ .video/ .view/ .viewpage__10/ .vm/ .vmdk/ .vn/ .vorteil/ .vs/ .vsprintf/ .vspscc/ .vssscc/ .vstemplate/ .vtl/ .vx/ .vxlpub/ .w/ .w3m/ .w3x/ .war/ .wav/ .WAV/ .wax/ .wbmp/ .wbp/ .wci/ .Web.UI.WebResource.axd/ .web/ .Web/ .webalizer/ .webarchive/ .webc/ .webinfo/ .webm/ .webproj/ .wgx/ .wihtm/ .wireless/ .wm/ .wma/ .wmf/ .wml/ .wmv/ .WMV/ .woa/ .work/ .working/ .wp/ .wpd/ .wpl/ .wplus/ .wps/ .wri/ .ws/ .wsc/ .wsdl/ .WTC/ .wvx/ .wws/ .www/ .x/ .xconf/ .xgi/ .xhtm/ .xhtml/ .xhtml5/ .xls/ .XLS/ .xlsx/ .xlt/ .xm/ .xml/ .Xml/ .XML/ .XMLHTTP/ .xpdf/ .xpi/ .xpml/ .xqy/ .xsd/ .xsl/ .xslt/ .xslx/ .xsp/ .xspf/ .xsql/ .xst/ .xsx/ .y/ .yp/ .ys/ .z/ .Z/ .za/ .zdat/ .zhtml/ .Zif/ .zip/ .Zip/ .ZIP/ .zml/ .ztml/'"
# Enabled and modified - 0xTaylor
#setvar:'tx.restricted_extensions=.asa/ .asax/ .ascx/ .axd/ .backup/ .bak/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/ .csproj/ .csr/ .dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .ini/ .key/ .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/ .pol/ .printer/ .pwd/ .rdb/ .resources/ .resx/ .sql/ .swp/ .sys/ .vb/ .vbs/ .vbproj/ .vsdisco/ .webinfo/ .xsd/ .xsx/'"

# Forbidden request headers.
# Header names should be lowercase, enclosed by /slashes/ as delimiters.
# Blocking Proxy header prevents 'httpoxy' vulnerability: https://httpoxy.org
# Default: /proxy/ /lock-token/ /content-range/ /if/
# Uncomment this rule to change the default.
#SecAction \
 "id:900250,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.restricted_headers=/a-im/ /accept-application/ /accept-ch-lifetime/ /accept-ch/ /accept-charset/ /accept-datetime/ /accept-encodxng/ /accept-patch/ /accept-ranges/ /accept-version/ /accepted/ /access-control-allow-credentials/ /access-control-allow-headers/ /access-control-allow-methods/ /access-control-allow-origin/ /access-control-expose-headers/ /access-control-max-age/ /access-control-request-headers/ /access-control-request-method/ /access-token/ /accesskey/ /action/ /admin/ /age/ /ajax/ /akamai-origin-hop/ /allow/ /alt-svc/ /app-env/ /app-key/ /app/ /appcookie/ /apply-to-redirect-ref/ /appname/ /appversion/ /atcept-language/ /auth-any/ /auth-basic/ /auth-digest-ie/ /auth-digest/ /auth-gssneg/ /auth-key/ /auth-ntlm/ /auth-password/ /auth-realm/ /auth-type/ /auth-user/ /auth/ /authentication/ /authorization/ /bad-gateway/ /bad-request/ /bae-env-addr-bcms/ /bae-env-addr-bcs/ /bae-env-addr-bus/ /bae-env-addr-channel/ /bae-env-addr-sql-ip/ /bae-env-addr-sql-port/ /bae-env-ak/ /bae-env-appid/ /bae-env-sk/ /bae-logid/ /bar/ /base-url/ /base/ /basic/ /bearer-indication/ /body-maxlength/ /body-truncated/ /brief/ /browser-user-agent/ /cache-control/ /cache-info/ /case-files/ /catalog-server/ /catalog/ /category/ /cert-cookie/ /cert-flags/ /cert-issuer/ /cert-keysize/ /cert-secretkeysize/ /cert-serialnumber/ /cert-server-issuer/ /cert-server-subject/ /cert-subject/ /cf-connecting-ip/ /cf-ipcountry/ /cf-template-path/ /cf-visitor/ /ch/ /challenge-response/ /charset/ /chunk-size/ /clear-site-data/ /client-address/ /client-bad-request/ /client-conflict/ /client-error-cannot-access-local-file/ /client-error-cannot-connect/ /client-error-communication-failure/ /client-error-connect/ /client-error-invalid-parameters/ /client-error-invalid-server-address/ /client-error-no-error/ /client-error-protocol-failure/ /client-error-unspecified-error/ /client-expectation-failed/ /client-forbidden/ /client-gone/ /client-ip/ /client-length-required/ /client-method-not-allowed/ /client-not-acceptable/ /client-not-found/ /client-payment-required/ /client-precondition-failed/ /client-proxy-auth-required/ /client-quirk-mode/ /client-request-timeout/ /client-request-too-large/ /client-request-uri-too-large/ /client-requested-range-not-possible/ /client-unauthorized/ /client-unsupported-media-type/ /client/ /clientaddress/ /clientip/ /cloudfront-viewer-country/ /cloudinary-name/ /cloudinary-public-id/ /cloudinary-version/ /cloudinaryurl/ /cluster-client-ip/ /code/ /coming-from/ /compress/ /conflict/ /connection-type/ /connection/ /contact/ /content-disposition/ /content-encoding/ /content-language/ /content-length/ /content-location/ /content-md5/ /content-range/ /content-security-policy-report-only/ /content-security-policy/ /content-type-xhtml/ /content-type/ /content/ /context-path/ /continue/ /cookie-domain/ /cookie-httponly/ /cookie-parse-raw/ /cookie-path/ /cookie-secure/ /cookie-vars/ /cookie/ /cookie2/ /cookies/ /core-base/ /correlates/ /created/ /credentials-filepath/ /cross-origin-resource-policy/ /curl-multithreaded/ /curl/ /custom-header/ /custom-secret-header/ /dataserviceversion/ /date/ /debug/ /deflate-level-def/ /deflate-level-max/ /deflate-level-min/ /deflate-strategy-def/ /deflate-strategy-filt/ /deflate-strategy-fixed/ /deflate-strategy-huff/ /deflate-strategy-rle/ /deflate-type-gzip/ /deflate-type-raw/ /deflate-type-zlib/ /delete/ /delta-base/ /depth/ /destination/ /destroy/ /devblocksproxybase/ /devblocksproxyhost/ /devblocksproxyssl/ /device-memory/ /device-stock-ua/ /digest/ /dir-name/ /dir-resource/ /dir/ /disable-gzip/ /dkim-signature/ /dnt/ /download-attachment/ /download-bad-url/ /download-bz2/ /download-cut-short/ /download-e-headers-sent/ /download-e-invalid-archive-type/ /download-e-invalid-content-type/ /download-e-invalid-file/ /download-e-invalid-param/ /download-e-invalid-request/ /download-e-invalid-resource/ /download-e-no-ext-mmagic/ /download-e-no-ext-zlib/ /download-inline/ /download-mime-type/ /download-no-server/ /download-size/ /download-status-not-found/ /download-status-server-error/ /download-status-unauthorized/ /download-status-unknown/ /download-tar/ /download-tgz/ /download-url/ /download-zip/ /dpr/ /e-encoding/ /e-header/ /e-invalid-param/ /e-malformed-headers/ /e-message-type/ /e-querystring/ /e-request-method/ /e-request-pool/ /e-request/ /e-response/ /e-runtime/ /e-socket/ /e-url/ /early-data/ /enable-gzip/ /enable-no-cache-headers/ /encoding-stream-flush-full/ /encoding-stream-flush-none/ /encoding-stream-flush-sync/ /env-silla-environment/ /env-vars/ /error-1/ /error-2/ /error-3/ /error-4/ /error-formatting-html/ /error/ /espo-authorization/ /espo-cgi-auth/ /etag/ /eve-charid/ /eve-charname/ /eve-solarsystemid/ /eve-solarsystemname/ /eve-trusted/ /ex-copy-movie/ /expect-ct/ /expect/ /expectation-failed/ /expires/ /ext/ /failed-dependency/ /fake-header/ /fastly-client-ip/ /fb-appid/ /fb-secret/ /feature-policy/ /file-not-found/ /filename/ /files-vars/ /files/ /fire-breathing-dragon/ /foo-bar/ /foo/ /forbidden/ /force-language/ /force-local-xhprof/ /format/ /forwarded-for-ip/ /forwarded-for/ /forwarded-proto/ /forwarded/ /from/ /fromlink/ /front-end-https/ /gateway-interface/ /gateway-time-out/ /get-vars/ /get/ /givenname/ /global-all/ /global-cookie/ /global-get/ /global-post/ /gone/ /google-code-project-hosting-hook-hmac/ /gzip-level/ /h0st/ /head/ /header-lf/ /header-status-client-error/ /header-status-informational/ /header-status-redirect/ /header-status-server-error/ /header-status-successful/ /header/ /home/ /host-liveserver/ /host-name/ /host-unavailable/ /hosti/ /htaccess/ /http_client_ip/ /http_forwarded_for/ /http_x_forwarded_for/ /http_x_forwarded/ /http-accept-encoding/ /http-accept-language/ /http-accept/ /http-authorization/ /http-connection/ /http-cookie/ /http-host/ /http-phone-number/ /http-referer/ /http-url/ /http-user-agent/ /http2-settings/ /https-from-lb/ /https-keysize/ /https-secretkeysize/ /https-server-issuer/ /https-server-subject/ /https/ /if-match/ /if-modified-since-version/ /if-modified-since/ /if-none-match/ /if-posted-before/ /if-range/ /if-unmodified-since-version/ /if-unmodified-since/ /if/ /im/ /image/ /images/ /incap-client-ip/ /info-download-size/ /info-download-time/ /info-return-code/ /info-total-request-stat/ /info-total-response-stat/ /info/ /insufficient-storage/ /internal-server-error/ /ipresolve-any/ /ipresolve-v4/ /ipresolve-v6/ /ischedule-version/ /iv-groups/ /iv-user/ /javascript/ /jenkins/ /keep-alive/ /kiss-rpc/ /label/ /large-allocation/ /last-event-id/ /last-modified/ /length-required/ /link/ /local-addr/ /local-content-sha1/ /local-dir/ /location/ /lock-token/ /locked/ /mail/ /mandatory/ /max-conn/ /max-forwards/ /max-request-size/ /max-uri-length/ /maxdataserviceversion/ /message-b/ /message/ /meth-/ /meth-acl/ /meth-baseline-control/ /meth-checkin/ /meth-checkout/ /meth-connect/ /meth-copy/ /meth-delete/ /meth-get/ /meth-head/ /meth-label/ /meth-lock/ /meth-merge/ /meth-mkactivity/ /meth-mkcol/ /meth-mkworkspace/ /meth-move/ /meth-options/ /meth-post/ /meth-propfind/ /meth-proppatch/ /meth-put/ /meth-report/ /meth-trace/ /meth-uncheckout/ /meth-unlock/ /meth-update/ /meth-version-control/ /method-not-allowed/ /method/ /mimetype/ /mod-env/ /mod-rewrite/ /mod-security-message/ /modauth/ /mode/ /module-class-path/ /module-class/ /module-name/ /moved-permanently/ /moved-temporarily/ /ms-asprotocolversion/ /msg-none/ /msg-request/ /msg-response/ /msisdn/ /multi-status/ /multipart-boundary/ /multiple-choices/ /must/ /my-header/ /mysqlport/ /native-sockets/ /negotiate/ /nl/ /no-content/ /non-authoritative/ /nonce/ /not-acceptable/ /not-exists/ /not-extended/ /not-found/ /not-implemented/ /not-modified/ /notification-template/ /oc-chunked/ /ocs-apirequest/ /ok/ /on-behalf-of/ /onerror-continue/ /onerror-die/ /onerror-return/ /only/ /opencart/ /options/ /organizer/ /orig_path_info/ /origin/ /originator/ /overwrite/ /p3p/ /params-allow-comma/ /params-allow-failure/ /params-default/ /params-get-catid/ /params-get-currentday/ /params-get-disposition/ /params-get-downwards/ /params-get-givendate/ /params-get-lang/ /params-get-type/ /params-raise-error/ /partial-content/ /passkey/ /password/ /path-base/ /path-info/ /path-themes/ /path-translated/ /path/ /payment-required/ /pc-remote-addr/ /permanent/ /phone-number/ /php-auth-pw/ /php-auth-user/ /php/ /phpthreads/ /pink-pony/ /port/ /portsensor-auth/ /post-error/ /post-files/ /post-vars/ /post/ /postredir-301/ /postredir-302/ /postredir-all/ /pragma-no-cache/ /pragma/ /precondition-failed/ /prefer/ /processing/ /profile/ /protocol/ /protocols/ /proxy-agent/ /proxy-authenticate/ /proxy-authentication-required/ /proxy-authorization/ /proxy-connection/ /proxy-connectionhttp_forwarded/ /proxy-host/ /proxy-http-1-0/ /proxy-http/ /proxy-password/ /proxy-port/ /proxy-pwd/ /proxy-request-fulluri/ /proxy-socks4/ /proxy-socks4a/ /proxy-socks5-hostname/ /proxy-socks5/ /proxy-url/ /proxy-user/ /proxy/ /public-key-pins-report-only/ /public-key-pins/ /pull/ /put/ /query-string/ /querystring-type-array/ /querystring-type-bool/ /querystring-type-float/ /querystring-type-int/ /querystring-type-object/ /querystring-type-string/ /querystring/ /range-not-satisfiable/ /range/ /raw-post-data/ /read-state-begin/ /read-state-body/ /read-state-headers/ /real-ip/ /real-method/ /reason-phrase/ /reason/ /recipient/ /redirect-found/ /redirect-perm/ /redirect-post/ /redirect-problem-withoutwww/ /redirect-problem-withwww/ /redirect-proxy/ /redirect-temp/ /redirect/ /redirected-accept-language/ /redirection-found/ /redirection-multiple-choices/ /redirection-not-modified/ /redirection-permanent/ /redirection-see-other/ /redirection-temporary/ /redirection-unused/ /redirection-use-proxy/ /ref/ /referrer-policy/ /referrer/ /refferer/ /refresh/ /remix-hash/ /remote-addr/ /remote-host-wp/ /remote-host/ /remote-user/ /remote-userhttps/ /report-to/ /request-entity-too-large/ /request-error-file/ /request-error-gzip-crc/ /request-error-gzip-data/ /request-error-gzip-method/ /request-error-gzip-read/ /request-error-proxy/ /request-error-redirects/ /request-error-response/ /request-error-url/ /request-error/ /request-http-ver-1-0/ /request-http-ver-1-1/ /request-mbstring/ /request-method-/ /request-method-delete/ /request-method-get/ /request-method-head/ /request-method-options/ /request-method-post/ /request-method-put/ /request-method-trace/ /request-method/ /request-time-out/ /request-timeout/ /request-uri-too-large/ /request-uri/ /request-vars/ /request/ /request2-tests-base-url/ /request2-tests-proxy-host/ /requesttoken/ /reset-content/ /response/ /rest-key/ /rest-sign/ /retry-after/ /returned-error/ /rlnclientipaddr/ /root/ /safe-ports-list/ /safe-ports-ssl-list/ /save-data/ /schedule-reply/ /scheme/ /script-name/ /sec-fetch-user/ /sec-websocket-accept/ /sec-websocket-extensions/ /sec-websocket-key/ /sec-websocket-key1/ /sec-websocket-key2/ /sec-websocket-origin/ /sec-websocket-protocol/ /sec-websocket-version/ /secretkey/ /see-other/ /self/ /send-x-frame-options/ /server-bad-gateway/ /server-error/ /server-gateway-timeout/ /server-internal/ /server-name/ /server-not-implemented/ /server-port-secure/ /server-port/ /server-protocol/ /server-service-unavailable/ /server-software/ /server-timing/ /server-unsupported-version/ /server-vars/ /server-varsabantecart/ /server/ /service-unavailable/ /session-id-tag/ /session-vars/ /set-cookie/ /set-cookie2/ /shib-/ /shib-application-id/ /shib-identity-provider/ /shib-logouturl/ /shopilex/ /slug/ /sn/ /soapaction/ /socket-connection-err/ /socketlog/ /somevar/ /sourcemap/ /sp-client/ /sp-host/ /ssl-https/ /ssl-offloaded/ /ssl-session-id/ /ssl-version-any/ /ssl/ /sslsessionid/ /start/ /status-/ /status-403-admin-del/ /status-403/ /status-404/ /status-bad-request/ /status-code/ /status-forbidden/ /status-ok/ /status-platform-403/ /status/ /str-match/ /strict-transport-security/ /success-accepted/ /success-created/ /success-no-content/ /success-non-authoritative/ /success-ok/ /success-partial-content/ /success-reset-content/ /support-encodings/ /support-events/ /support-magicmime/ /support-requests/ /support-sslrequests/ /support/ /surrogate-capability/ /switching-protocols/ /te/ /temporary-redirect/ /test-config/ /test-server-path/ /test-something-anything/ /test/ /ticket/ /time-out/ /timeout/ /timing-allow-origin/ /title/ /tk/ /tmp/ /token/ /trailer/ /transfer-encoding/ /translate/ /transport-err/ /true-client-ip/ /ua-color/ /ua-cpu/ /ua-os/ /ua-pixels/ /ua-resolution/ /ua-voice/ /ua/ /unauthorized/ /unencoded-url/ /unit-test-mode/ /unless-modified-since/ /unprocessable-entity/ /unsupported-media-type/ /upgrade-insecure-requests/ /upgrade-required/ /upgrade/ /upload-default-chmod/ /uri/ /url-from-env/ /url-join-path/ /url-join-query/ /url-replace/ /url-sanitize-path/ /url-strip-/ /url-strip-all/ /url-strip-auth/ /url-strip-fragment/ /url-strip-pass/ /url-strip-path/ /url-strip-port/ /url-strip-query/ /url-strip-user/ /url/ /use-gzip/ /use-proxy/ /user-agent-via/ /user-agent/ /user-email/ /user-id/ /user-mail/ /user-name/ /user-photos/ /user/ /useragent-via/ /useragent/ /util/ /variant-also-varies/ /vary/ /verbose-throttle/ /verbose/ /verify-cert/ /version-1-0/ /version-1-1/ /version-any/ /version-none/ /version-not-supported/ /version/ /versioncode/ /via/ /viad/ /waf-stuff-below/ /want-digest/ /wap-connection/ /warning/ /web-server-api/ /webodf-member-id/ /webodf-session-id/ /webodf-session-revision/ /work-directory/ /www-address/ /www-authenticate/ /x_alto_ajax_key/ /x-/ /x-aastra-expmod1/ /x-aastra-expmod2/ /x-aastra-expmod3/ /x-accel-mapping/ /x-access-token/ /x-advertiser-id/ /x-ajax-real-method/ /x-alto-ajax-keyz/ /x-amz-date/ /x-amz-website-redirect-location/ /x-amzn-remapped-host/ /x-api-key/ /x-api-signature/ /x-api-timestamp/ /x-apitoken/ /x-apple-client-application/ /x-apple-store-front/ /x-arr-log-id/ /x-arr-ssl/ /x-att-deviceid/ /x-auth-key/ /x-auth-mode/ /x-auth-password/ /x-auth-service-provider/ /x-auth-token/ /x-auth-user/ /x-auth-userid/ /x-auth-username/ /x-authentication-key/ /x-authentication/ /x-authorization/ /x-avantgo-screensize/ /x-azc-remote-addr/ /x-bear-ajax-request/ /x-bluecoat-via/ /x-bolt-phone-ua/ /x-browser-height/ /x-browser-width/ /x-cascade/ /x-cept-encoding/ /x-cf-url/ /x-chrome-extension/ /x-cisco-bbsm-clientip/ /x-client-host/ /x-client-id/ /x-client-ip/ /x-client-key/ /x-client-os-ver/ /x-client-os/ /x-clientip/ /x-cluster-client-ip/ /x-codeception-codecoverage-config/ /x-codeception-codecoverage-debug/ /x-codeception-codecoverage-suite/ /x-codeception-codecoverage/ /x-collect-coverage/ /x-coming-from/ /x-confirm-delete/ /x-content-type-options/ /x-content-type/ /x-correlation-id/ /x-credentials-request/ /x-csrf-crumb/ /x-csrf-token/ /x-csrftoken/ /x-cuid/ /x-custom/ /x-dagd-proxy/ /x-davical-testcase/ /x-dcmguid/ /x-debug-test/ /x-device-user-agent/ /x-dialog/ /x-dns-prefetch-control/ /x-do-not-track/ /x-dokuwiki-do/ /x-drestcg/ /x-dsid/ /x-elgg-apikey/ /x-elgg-hmac-algo/ /x-elgg-hmac/ /x-elgg-nonce/ /x-elgg-posthash-algo/ /x-elgg-posthash/ /x-elgg-time/ /x-em-uid/ /x-enable-coverage/ /x-environment-override/ /x-expected-entity-length/ /x-experience-api-version/ /x-fb-user-remote-addr/ /x-file-id/ /x-file-name/ /x-file-resume/ /x-file-size/ /x-file-type/ /x-filename/ /x-firelogger/ /x-fireloggerauth/ /x-firephp-version/ /x-flash-version/ /x-flx-consumer-key/ /x-flx-consumer-secret/ /x-flx-redirect-url/ /x-foo-bar/ /x-foo/ /x-forward-for/ /x-forward-proto/ /x-forwarded-by/ /x-forwarded-for-original/ /x-forwarded-for/ /x-forwarded-host/ /x-forwarded-port/ /x-forwarded-proto/ /x-forwarded-protocol/ /x-forwarded-scheme/ /x-forwarded-server/ /x-forwarded-ssl/ /x-forwarded/ /x-forwarder-for/ /x-frame-options/ /x-from/ /x-gb-shared-secret/ /x-geoip-country/ /x-get-checksum/ /x-helpscout-event/ /x-helpscout-signature/ /x-hgarg-/ /x-host/ /x-http-destinationurl/ /x-http-host-override/ /x-http-method-override/ /x-http-method/ /x-http-path-override/ /x-https/ /x-htx-agent/ /x-huawei-userid/ /x-hub-signature/ /x-if-unmodified-since/ /x-imbo-test-config/ /x-insight/ /x-ip-trail/ /x-ip/ /x-iwproxy-nesting/ /x-jphone-color/ /x-jphone-display/ /x-jphone-geocode/ /x-jphone-msname/ /x-jphone-uid/ /x-json/ /x-kaltura-remote-addr/ /x-known-signature/ /x-known-username/ /x-litmus-second/ /x-litmus/ /x-locking/ /x-machine/ /x-mandrill-signature/ /x-method-override/ /x-mobile-gateway/ /x-mobile-ua/ /x-mosso-dt/ /x-moz/ /x-ms-policykey/ /x-msisdn/ /x-myqee-system-debug/ /x-myqee-system-hash/ /x-myqee-system-isadmin/ /x-myqee-system-isrest/ /x-myqee-system-pathinfo/ /x-myqee-system-project/ /x-myqee-system-rstr/ /x-myqee-system-time/ /x-network-info/ /x-nfsn-https/ /x-ning-request-uri/ /x-nokia-bearer/ /x-nokia-connection-mode/ /x-nokia-gateway-id/ /x-nokia-ipaddress/ /x-nokia-msisdn/ /x-nokia-wia-accept-original/ /x-nokia-wtls/ /x-nuget-apikey/ /x-oc-mtime/ /x-opera-info/ /x-operamini-features/ /x-operamini-phone-ua/ /x-operamini-phone/ /x-options/ /x-orange-id/ /x-orchestra-scheme/ /x-orig-client/ /x-original-host/ /x-original-http-command/ /x-original-remote-addr/ /x-original-url/ /x-original-user-agent/ /x-originally-forwarded-for/ /x-originally-forwarded-proto/ /x-originating-ip/ /x-os-prefs/ /x-overlay/ /x-pagelet-fragment/ /x-password/ /x-phabricator-csrf/ /x-phpbb-using-plupload/ /x-pjax-container/ /x-pjax/ /x-prototype-version/ /x-proxy-url/ /x-proxyuser-ip/ /x-pswd/ /x-purpose/ /x-qafoo-profiler/ /x-real-ip/ /x-remote-addr/ /x-remote-ip/ /x-remote-protocol/ /x-render-partial/ /x-request-id/ /x-request-signature/ /x-request-start/ /x-request-timestamp/ /x-request/ /x-requested-with/ /x-response-format/ /x-rest-cors/ /x-rest-password/ /x-rest-username/ /x-rewrite-url/ /x-sakura-forwarded-for/ /x-scalr-auth-key/ /x-scalr-auth-token/ /x-scalr-env-id/ /x-scanner/ /x-scheme/ /x-screen-height/ /x-screen-width/ /x-sendfile-type/ /x-serial-number/ /x-serialize/ /x-server-id/ /x-server-name/ /x-server-port/ /x-signature/ /x-sina-proxyuser/ /x-skyfire-phone/ /x-skyfire-screen/ /x-ssl/ /x-subdomain/ /x-te/ /x-teamsite-preremap/ /x-test-session-id/ /x-timer/ /x-tine20-jsonkey/ /x-tine20-request-type/ /x-tomboy-client/ /x-tor/ /x-twilio-signature/ /x-ua-device/ /x-ucbrowser-device-ua/ /x-uidh/ /x-unique-id/ /x-uniquewcid/ /x-up-calling-line-id/ /x-up-devcap-iscolor/ /x-up-devcap-screendepth/ /x-up-devcap-screenpixels/ /x-up-subno/ /x-update-range/ /x-update/ /x-upload-maxresolution/ /x-upload-name/ /x-upload-size/ /x-upload-type/ /x-url-scheme/ /x-user-agent/ /x-user/ /x-username/ /x-varnish/ /x-verify-credentials-authorization/ /x-vodafone-3gpdpcontext/ /x-wap-client-sdu-size/ /x-wap-clientid/ /x-wap-gateway/ /x-wap-network-client-ip/ /x-wap-network-client-msisdn/ /x-wap-profile/ /x-wap-proxy-cookie/ /x-wap-session-id/ /x-wap-tod-coded/ /x-wap-tod/ /x-whatever/ /x-wikimedia-debug/ /x-wp-nonce/ /x-wp-pjax-prefetch/ /x-ws-api-key/ /x-xc-schema-version/ /x-xhprof-debug/ /x-xhr-referer/ /x-xmlhttprequest/ /x-xpid/ /x-xsrf-token/ /x-xss-protection/ /x-zikula-ajax-token/ /x-zotero-version/ /x-ztgo-bearerinfo/ /x/ /xauthorization/ /xonnection/ /xpdb-debugger/ /xproxy/ /xroxy-connection/ /xxx-real-ip/ /xxxxxxxxxxxxxxx/ /y/ /zotero-api-version/ /zotero-write-token/'"
  # Enabled and modified - 0xTaylor
  #setvar:'tx.restricted_headers=/proxy/ /lock-token/ /content-range/ /if/'"

# File extensions considered static files.
# Extensions include the dot, lowercase, enclosed by /slashes/ as delimiters.
# Used in DoS protection rule. See section "Anti-Automation / DoS Protection".
# Default: /.jpg/ /.jpeg/ /.png/ /.gif/ /.js/ /.css/ /.ico/ /.svg/ /.webp/
# Uncomment this rule to change the default.
SecAction \
 "id:900260,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.static_extensions=/.png/ /.js/ /.css/ /.ico/ /.html/'"
  
#  setvar:'tx.static_extensions=/.jpg/ /.jpeg/ /.png/ /.gif/ /.js/ /.css/ /.ico/ /.svg/ /.webp/'"

# Content-Types charsets that a client is allowed to send in a request.
# Default: utf-8|iso-8859-1|iso-8859-15|windows-1252
# Uncomment this rule to change the default.
# Use "|" to separate multiple charsets like in the rule defining
# tx.allowed_request_content_type.
#SecAction \
# "id:900280,\
#  phase:1,\
#  nolog,\
#  pass,\
#  t:none,\
#  setvar:'tx.allowed_request_content_type_charset=utf-8|iso-8859-1|iso-8859-15|windows-1252'"

#
# -- [[ HTTP Argument/Upload Limits ]] -----------------------------------------
#
# Here you can define optional limits on HTTP get/post parameters and uploads.
# This can help to prevent application specific DoS attacks.
#
# These values are checked in REQUEST-920-PROTOCOL-ENFORCEMENT.conf.
# Beware of blocking legitimate traffic when enabling these limits.
#

# Block request if number of arguments is too high
# Default: unlimited
# Example: 255
# Uncomment this rule to set a limit.
SecAction \
 "id:900300,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.max_num_args=10" # Lowered from 255
  #Enabled by 0xTaylor 

# Block request if the length of any argument name is too high
# Default: unlimited
# Example: 100
# Uncomment this rule to set a limit.
SecAction \
 "id:900310,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.arg_name_length=30" #Lowered from 100
# Enabled by 0xTaylor

# Block request if the length of any argument value is too high
# Default: unlimited
# Example: 400
# Uncomment this rule to set a limit.
SecAction \
 "id:900320,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.arg_length=400" #Lowered from 400
  # Enabled by 0xTaylor

# Block request if the total length of all combined arguments is too high
# Default: unlimited
# Example: 64000
# Uncomment this rule to set a limit.
SecAction \
 "id:900330,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.total_arg_length=64000" # Lowered to 750 
  # Enabled by 0xTaylor

# Block request if the file size of any individual uploaded file is too high
# Default: unlimited
# Example: 1048576
# Uncomment this rule to set a limit.
#SecAction \
# "id:900340,\
#  phase:1,\
#  nolog,\
#  pass,\
#  t:none,\
#  setvar:tx.max_file_size=1048576"

# Block request if the total size of all combined uploaded files is too high
# Default: unlimited
# Example: 1048576
# Uncomment this rule to set a limit.
#SecAction \
# "id:900350,\
#  phase:1,\
#  nolog,\
#  pass,\
#  t:none,\
#  setvar:tx.combined_file_sizes=1048576"


#
# -- [[ Easing In / Sampling Percentage ]] -------------------------------------
#
# Adding the Core Rule Set to an existing productive site can lead to false
# positives, unexpected performance issues and other undesired side effects.
#
# It can be beneficial to test the water first by enabling the CRS for a
# limited number of requests only and then, when you have solved the issues (if
# any) and you have confidence in the setup, to raise the ratio of requests
# being sent into the ruleset.
#
# Adjust the percentage of requests that are funnelled into the Core Rules by
# setting TX.sampling_percentage below. The default is 100, meaning that every
# request gets checked by the CRS.  The selection of requests, which are going
# to be checked, is based on a pseudo random number generated by ModSecurity.
#
# If a request is allowed to pass without being checked by the CRS, there is no
# entry in the audit log (for performance reasons), but an error log entry is
# written.  If you want to disable the error log entry, then issue the
# following directive somewhere after the inclusion of the CRS
# (E.g., RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf).
#
# SecRuleUpdateActionById 901150 "nolog"
#
# ATTENTION: If this TX.sampling_percentage is below 100, then some of the
# requests will bypass the Core Rules completely and you lose the ability to
# protect your service with ModSecurity.
#
# Uncomment this rule to enable this feature:
#
SecAction "id:900400,\
  phase:1,\
  pass,\
  nolog,\
  setvar:tx.sampling_percentage=100"


#
# -- [[ Project Honey Pot HTTP Blacklist ]] ------------------------------------
#
# Optionally, you can check the client IP address against the Project Honey Pot
# HTTPBL (dnsbl.httpbl.org). In order to use this, you need to register to get a
# free API key. Set it here with SecHttpBlKey.
#
# Project Honeypot returns multiple different malicious IP types.
# You may specify which you want to block by enabling or disabling them below.
#
# Ref: https://www.projecthoneypot.org/httpbl.php
# Ref: https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecHttpBlKey
#
# Uncomment these rules to use this feature:
#
#SecHttpBlKey fxfuqgkmrfte # Registered by 0xTaylor
#SecAction "id:900500,\
#  phase:1,\
#  nolog,\
#  pass,\
#  t:none,\
#  setvar:tx.block_search_ip=0,\ 
#  setvar:tx.block_suspicious_ip=1,\
#  setvar:tx.block_harvester_ip=1,\
#  setvar:tx.block_spammer_ip=1"
  # Enabled by 0xTaylor
# Disabled to prevent search engine issues

#
# -- [[ GeoIP Database ]] ------------------------------------------------------
#
# There are some rulesets that inspect geolocation data of the client IP address
# (geoLookup). The CRS uses geoLookup to implement optional country blocking.
#
# To use geolocation, we make use of the MaxMind GeoIP database.
# This database is not included with the CRS and must be downloaded.
#
# There are two formats for the GeoIP database. ModSecurity v2 uses GeoLite (.dat files),
# and ModSecurity v3 uses GeoLite2 (.mmdb files).
#
# If you use ModSecurity 3, MaxMind provides a binary for updating GeoLite2 files,
# see https://github.com/maxmind/geoipupdate.
#
# Download the package for your OS, and read https://dev.maxmind.com/geoip/geoipupdate/
# for configuration options.
#
# Warning: GeoLite (not GeoLite2) databases are considered legacy, and not being updated anymore.
# See https://support.maxmind.com/geolite-legacy-discontinuation-notice/ for more info.
#
# Therefore, if you use ModSecurity v2, you need to regenerate updated .dat files
# from CSV files first.
#
# You can achieve this using https://github.com/sherpya/geolite2legacy
# Pick the zip files from maxmind site:
# https://geolite.maxmind.com/download/geoip/database/GeoLite2-Country-CSV.zip
#
# Follow the guidelines for installing the tool and run:
# ./geolite2legacy.py -i GeoLite2-Country-CSV.zip \
#                     -f geoname2fips.csv -o /usr/share/GeoliteCountry.dat
#
# Update the database regularly, see Step 3 of the configuration link above.
#
# By default, when you execute `sudo geoipupdate` on Linux, files from the free database
# will be downloaded to `/usr/share/GeoIP` (both v1 and v2).
#
# Then choose from:
#   - `GeoLite2-Country.mmdb` (if you are using ModSecurity v3)
#   - `GeoLiteCountry.dat`    (if you are using ModSecurity v2)
#
# Ref: http://blog.spiderlabs.com/2010/10/detecting-malice-with-modsecurity-geolocation-data.html
# Ref: http://blog.spiderlabs.com/2010/11/detecting-malice-with-modsecurity-ip-forensics.html
#
# Uncomment only one of the next rules here to use this feature.
# Choose the one depending on the ModSecurity version you are using, and change the path accordingly:
#
# For ModSecurity v3:
#SecGeoLookupDB /usr/share/GeoIP/GeoLite2-Country.mmdb
# For ModSecurity v2 (points to the converted one):
#SecGeoLookupDB /usr/share/GeoIP/GeoLiteCountry.dat

#
# -=[ Block Countries ]=-
#
# Rules in the IP Reputation file can check the client against a list of high
# risk country codes. These countries have to be defined in the variable
# tx.high_risk_country_codes via their ISO 3166 two-letter country code:
# https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2#Officially_assigned_code_elements
#
# If you are sure that you are not getting any legitimate requests from a given
# country, then you can disable all access from that country via this variable.
# The rule performing the test has the rule id 910100.
#
# This rule requires SecGeoLookupDB to be enabled and the GeoIP database to be
# downloaded (see the section "GeoIP Database" above.)
#
# By default, the list is empty. A list used by some sites was the following:
# setvar:'tx.high_risk_country_codes=UA ID YU LT EG RO BG TR RU PK MY CN'"
#
# Uncomment this rule to use this feature:
#
#SecAction \
# "id:900600,\
#  phase:1,\
#  nolog,\
#  pass,\
#  t:none,\
#  setvar:'tx.high_risk_country_codes='"


#
# -- [[ Anti-Automation / DoS Protection ]] ------------------------------------
#
# Optional DoS protection against clients making requests too quickly.
#
# When a client is making more than 100 requests (excluding static files) within
# 60 seconds, this is considered a 'burst'. After two bursts, the client is
# blocked for 600 seconds.
#
# Requests to static files are not counted towards DoS; they are listed in the
# 'tx.static_extensions' setting, which you can change in this file (see
# section "HTTP Policy Settings").
#
# For a detailed description, see rule file REQUEST-912-DOS-PROTECTION.conf.
#
# Uncomment this rule to use this feature:
#
SecAction \
 "id:900700,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.dos_burst_time_slice=30',\
  setvar:'tx.dos_counter_threshold=150',\
  setvar:'tx.dos_block_timeout=600'"
  # Enabled by 0xTaylor - May need to tune

  #setvar:'tx.dos_burst_time_slice=60\',\
  #setvar:'tx.dos_counter_threshold='500,\
  #setvar:'tx.dos_block_timeout=600'"


#
# -- [[ Check UTF-8 encoding ]] ------------------------------------------------
#
# The CRS can optionally check request contents for invalid UTF-8 encoding.
# We only want to apply this check if UTF-8 encoding is actually used by the
# site; otherwise it will result in false positives.
#
# Uncomment this rule to use this feature:
#
#SecAction \
# "id:900950,\
#  phase:1,\
#  nolog,\
#  pass,\
#  t:none,\
#  setvar:tx.crs_validate_utf8_encoding=1"


#
# -- [[ Blocking Based on IP Reputation ]] ------------------------------------
#
# Blocking based on reputation is permanent in the CRS. Unlike other rules,
# which look at the individual request, the blocking of IPs is based on
# a persistent record in the IP collection, which remains active for a
# certain amount of time.
#
# There are two ways an individual client can become flagged for blocking:
# - External information (RBL, GeoIP, etc.)
# - Internal information (Core Rules)
#
# The record in the IP collection carries a flag, which tags requests from
# individual clients with a flag named IP.reput_block_flag.
# But the flag alone is not enough to have a client blocked. There is also
# a global switch named tx.do_reput_block. This is off by default. If you set
# it to 1 (=On), requests from clients with the IP.reput_block_flag will
# be blocked for a certain duration.
#
# Variables
# ip.reput_block_flag      Blocking flag for the IP collection record
# ip.reput_block_reason    Reason (= rule message) that caused to blocking flag
# tx.do_reput_block        Switch deciding if we really block based on flag
# tx.reput_block_duration  Setting to define the duration of a block
#
# It may be important to know, that all the other core rules are skipped for
# requests, when it is clear that they carry the blocking flag in question.
#
# Uncomment this rule to use this feature:
#
#SecAction \
# "id:900960,\
#  phase:1,\
#  nolog,\
#  pass,\
#  t:none,\
#  setvar:tx.do_reput_block=1"
# Potentially enable - 0xTaylor
#
# Uncomment this rule to change the blocking time:
# Default: 300 (5 minutes)
#
#SecAction \
# "id:900970,\
#  phase:1,\
#  nolog,\
#  pass,\
#  t:none,\
#  setvar:tx.reput_block_duration=300"


#
# -- [[ Collection timeout ]] --------------------------------------------------
#
# Set the SecCollectionTimeout directive from the ModSecurity default (1 hour)
# to a lower setting which is appropriate to most sites.
# This increases performance by cleaning out stale collection (block) entries.
#
# This value should be greater than or equal to:
# tx.reput_block_duration (see section "Blocking Based on IP Reputation") and
# tx.dos_block_timeout (see section "Anti-Automation / DoS Protection").
#
# Ref: https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecCollectionTimeout

# Please keep this directive uncommented.
# Default: 600 (10 minutes)
SecCollectionTimeout 600


#
# -- [[ End of setup ]] --------------------------------------------------------
#
# The CRS checks the tx.crs_setup_version variable to ensure that the setup
# has been loaded. If you are not planning to use this setup template,
# you must manually set the tx.crs_setup_version variable before including
# the CRS rules/* files.
#
# The variable is a numerical representation of the CRS version number.
# E.g., v3.0.0 is represented as 300.
#
SecAction \
 "id:900990,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.crs_setup_version=330"